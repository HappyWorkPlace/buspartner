<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Improved Modern Collapsible Sidebar</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
 <style>
    /* General Styles */
    body {
        font-family: 'Arial', sans-serif;
        margin: 0;
        background: #f0f2f5;
        display: flex;
        height: 100vh;
        overflow: hidden;
    }

    /* Sidebar Styles */
    .sidebar {
        width: 260px;
        background-color: #2c3e50;
        color: #ecf0f1;
        box-shadow: 2px 0 12px rgba(0, 0, 0, 0.1);
        overflow-y: auto;
        transition: height 0.5s ease-out, width 0.3s ease;
        position: fixed;
        left: 0;
        height: auto; /* เริ่มต้นด้วยความสูงเต็มหน้าจอ */
        min-height: 100vh; /* ให้มีความสูงขั้นต่ำเท่ากับความสูงของหน้าจอ */
        z-index: 1000;
    }

    .sidebar.collapsed {
        width: 70px;
    }

    .sidebar-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 20px;
        background-color: #34495e;
    }

    .logo {
        display: flex;
        align-items: center;
        overflow: hidden;
    }

    .logo i {
        font-size: 24px;
        color: #3498db;
    }

    .logo-text {
        font-size: 20px;
        font-weight: bold;
        color: #ecf0f1;
        margin-left: 10px;
        transition: opacity 0.3s ease;
    }

    .sidebar.collapsed .logo-text {
        opacity: 0;
        width: 0;
    }

    .sidebar-toggle {
        background: none;
        border: none;
        cursor: pointer;
        color: #ecf0f1;
        font-size: 20px;
        outline: none;
    }

    /* Sidebar Menu */
    .sidebar-menu {
        list-style: none;
        padding: 0;
        margin: 20px 0;
        padding-bottom: 50px; /* Add extra space at the bottom */
    }

    .menu-item {
        position: relative;
        margin-bottom: 5px;
        transition: margin-bottom 0.3s ease;
    }

    .menu-item.open {
        margin-bottom: 10px;
    }

    .menu-item a {
        padding: 12px 20px;
        text-decoration: none;
        color: #ecf0f1;
        display: flex;
        align-items: center;
        transition: all 0.3s;
    }

    .menu-item a:hover, .menu-item.active > a {
        background-color: #3498db;
        border-radius: 5px;
        margin: 0 10px;
    }

    .menu-text {
        margin-left: 15px;
        white-space: nowrap;
        transition: opacity 0.3s ease;
    }

    .sidebar.collapsed .menu-text {
        opacity: 0;
        width: 0;
    }

    /* Submenu Styles */
    .submenu {
        list-style: none;
        padding-left: 20px;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.5s ease-out;
    }

    .menu-item.open > .submenu {
        max-height: 1000px; /* หรือค่าที่มากพอสำหรับเนื้อหาของคุณ */
        transition: max-height 0.5s ease-in;
    }

    .submenu li a {
        padding: 10px 20px;
        font-size: 14px;
    }

    .submenu .submenu li a {
        padding-left: 40px;
    }

    /* Dropdown indicators */
    .menu-item > a::after {
        content: '\f105';
        font-family: 'Font Awesome 5 Free';
        font-weight: 900;
        margin-left: auto;
        transition: transform 0.3s;
    }

    .menu-item.open > a::after {
        transform: rotate(90deg);
    }

    .sidebar.collapsed .menu-item > a::after {
        display: none;
    }

    /* Main Content Styles */
    .main-content {
        margin-left: 260px;
        padding: 20px;
        transition: margin-left 0.3s ease;
        width: calc(100% - 260px);
    }

    .sidebar.collapsed + .main-content {
        margin-left: 70px;
        width: calc(100% - 70px);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .sidebar {
            width: 100%;
            transform: translateX(-100%);
        }

        .sidebar.collapsed {
            transform: translateX(0);
            width: 100%;
        }

        .main-content {
            margin-left: 0;
            width: 100%;
        }

        .sidebar.collapsed + .main-content {
            margin-left: 0;
            width: 100%;
        }
    }
</style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-bus"></i>
                <span class="logo-text">BUS PARTNER</span>
            </div>
            <button class="sidebar-toggle" id="sidebar-toggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>

        <!-- Sidebar Menu -->
        <ul class="sidebar-menu">
            <li class="menu-item">
                <a href="#"><i class="fas fa-home"></i><span class="menu-text">Home</span></a>
            </li>
            <li class="menu-item">
                <a href="#"><i class="fas fa-laptop"></i><span class="menu-text">Program</span></a>
                <ul class="submenu">
                    <li><a href="#"><i class="fas fa-user-check"></i><span class="menu-text">Attendance Record</span></a></li>
                    <li><a href="#"><i class="fas fa-camera"></i><span class="menu-text">Camera Record</span></a></li>
                    <li><a href="#"><i class="far fa-calendar"></i><span class="menu-text">Bus Arrange Shift</span></a></li>
                    <li><a href="#"><i class="fas fa-wrench"></i><span class="menu-text">Maintenance Record</span></a></li>
                    <li class="menu-item">
                        <a href="#"><i class="fas fa-exclamation-circle"></i><span class="menu-text">Document Expire</span></a>
                        <ul class="submenu">
                            <li><a href="#"><i class="far fa-id-card"></i><span class="menu-text">Driver License Expire</span></a></li>
                            <li><a href="#"><i class="fas fa-clipboard-list"></i><span class="menu-text">Bus Document Expire</span></a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li class="menu-item">
                <a href="#"><i class="fas fa-cog"></i><span class="menu-text">Settings</span></a>
                <ul class="submenu">
                    <li><a href="#"><i class="fas fa-user-cog"></i><span class="menu-text">Account Management</span></a></li>
                    <li class="menu-item">
                        <a href="#"><i class="fas fa-bus"></i><span class="menu-text">Driver Database</span></a>
                        <ul class="submenu">
                            <li><a href="#"><i class="fas fa-user-plus"></i><span class="menu-text">Driver Registering</span></a></li>
                            <li><a href="#"><i class="fas fa-id-card"></i><span class="menu-text">Driver Data</span></a></li>
                        </ul>
                    </li>
                    <li class="menu-item">
                        <a href="#"><i class="fas fa-database"></i><span class="menu-text">Bus Database</span></a>
                        <ul class="submenu">
                            <li><a href="#"><i class="fas fa-bus-alt"></i><span class="menu-text">Bus Registering</span></a></li>
                            <li><a href="#"><i class="fas fa-clipboard-list"></i><span class="menu-text">Bus Data</span></a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li class="menu-item">
                <a href="#"><i class="fas fa-tools"></i><span class="menu-text">Admin Tools</span></a>
                <ul class="submenu">
                    <li><a href="#"><i class="fas fa-users-cog"></i><span class="menu-text">Admin Account Management</span></a></li>
                </ul>
            </li>
            <li class="menu-item">
                <a href="#"><i class="fas fa-user"></i><span class="menu-text">Profile</span></a>
            </li>
            <li class="menu-item">
                <a href="#"><i class="fas fa-sign-in-alt"></i><span class="menu-text">Login/Logout</span></a>
            </li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="main-content">
        <h1>Welcome to Bus Partner</h1>
        <p>This is the homepage of your dashboard.</p>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('main-content');
    const sidebarToggle = document.getElementById('sidebar-toggle');
    const sidebarMenu = document.querySelector('.sidebar-menu');

    function updateSidebarHeight() {
        const sidebarHeight = sidebarMenu.scrollHeight;
        sidebar.style.height = `${sidebarHeight}px`;
    }

    function toggleSubmenu(event) {
        event.preventDefault();
        event.stopPropagation();
        
        const menuItem = event.currentTarget.parentElement;
        const submenu = menuItem.querySelector(':scope > .submenu');
        
        if (submenu) {
            const isOpen = menuItem.classList.toggle('open');
            
            // ปิดเมนูย่อยอื่นๆ ในระดับเดียวกัน
            const siblings = menuItem.parentElement.children;
            Array.from(siblings).forEach(sibling => {
                if (sibling !== menuItem && sibling.classList.contains('open')) {
                    sibling.classList.remove('open');
                    const siblingSubmenu = sibling.querySelector(':scope > .submenu');
                    if (siblingSubmenu) {
                        siblingSubmenu.style.maxHeight = null;
                        siblingSubmenu.style.opacity = '0';
                    }
                }
            });

            // ปรับความสูงและความทึบของเมนูย่อยที่เปิด/ปิด
            if (isOpen) {
                submenu.style.maxHeight = submenu.scrollHeight + "px";
                submenu.style.opacity = '1';
            } else {
                submenu.style.maxHeight = null;
                submenu.style.opacity = '0';
            }

            // อัพเดทความสูงของ sidebar หลังจาก transition เสร็จสิ้น
            setTimeout(updateSidebarHeight, 500); // 500ms ตรงกับ transition ใน CSS
        }
    }

    // เพิ่ม event listener สำหรับทุกรายการเมนู
    document.querySelectorAll('.sidebar-menu .menu-item > a').forEach(item => {
        item.addEventListener('click', toggleSubmenu);
    });

    // Toggle sidebar
    sidebarToggle.addEventListener('click', function(event) {
        event.stopPropagation();
        sidebar.classList.toggle('collapsed');
        mainContent.classList.toggle('collapsed');
        updateSidebarHeight();
    });

    // Close sidebar on mobile when clicking outside
    document.addEventListener('click', function(event) {
        const isMobile = window.innerWidth <= 768;
        const isClickInsideSidebar = sidebar.contains(event.target);
        const isSidebarToggleClick = sidebarToggle.contains(event.target);

        if (isMobile && !isClickInsideSidebar && !isSidebarToggleClick && !sidebar.classList.contains('collapsed')) {
            sidebar.classList.add('collapsed');
        }
    });

    // Initial update of sidebar height
    updateSidebarHeight();

    // Update sidebar height on window resize
    window.addEventListener('resize', updateSidebarHeight);
});
    </script>
</body>
</html>
